# Disallow directories that start with . but allow well-known
location ~ /\.(?!well-known).* {
    deny all;
    access_log off;
    log_not_found off;
    try_files $uri =404;
}

# Prevent access to certain file extensions
location ~\.(ini|log|conf)$ {
    deny all;
    access_log off;
	log_not_found off;
}

# Block execution of PHP files in uploads directory
location ~* /(?:uploads|files)/.*.php$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Don't log not found errors for favicon
location ~* /favicon.ico {
    access_log off;
    log_not_found off;
}

# Block xmlrpc.php except for Jetpack IPs
location = /xmlrpc.php {
    allow 122.248.245.244/32;
    allow 54.217.201.243/32;
    allow 54.232.116.4/32;
    allow 192.0.64.0/18;
    allow 192.0.80.0/20;
    allow 192.0.96.0/20;
    allow 192.0.112.0/20;
    allow 195.234.108.0/22;
    deny all;
    access_log off;
    log_not_found off;
    return 444;
}
